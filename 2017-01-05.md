# shell æ“ä½œ

å› ä¸ºä»Šå¤©æœ‰ä¸€ä¸ªä»»åŠ¡æ‰¹é‡åˆ é™¤ redis ä¸­æœªè®¾ç½®è¶…æœŸæ—¶é—´ï¼Œkey ç¬¦åˆ "prefix:*" çš„è®°å½•ï¼Œ redis æ²¡æœ‰å¯¹åº”çš„å‘½ä»¤ï¼Œæ‰€ä»¥å°±é€šè¿‡ shell æ¥æ“ä½œäº†ã€‚

å…ˆæ¥ç§‘æ™®å‡ ä¸ª shell å‘½ä»¤

## ç®¡é“æ“ä½œ |

å°†å‰ä¸€ä¸ªæŒ‡ä»¤çš„ *æ­£ç¡®* è¾“å‡ºä¿¡æ¯ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå‘½ä»¤ï¼Œä½œä¸ºå…¶æ ‡å‡†è¾“å…¥ï¼Œæ‰€ä»¥ï¼šå·¦è¾¹çš„å‘½ä»¤åº”è¯¥æœ‰æ ‡å‡†è¾“å‡º | å³è¾¹çš„å‘½ä»¤åº”è¯¥æŽ¥å—æ ‡å‡†è¾“å…¥

ðŸŒ°

```
redis-cli keys "*" | read LINE; echo "first line is $LINE";
```


## while

```
while argument; do
    do sth
done
```

ðŸŒ°

```
while read LINE; do
    echo "$LINE"
done
```


## if

```
if list; then
    do sth
elif list then
    do sth
else
    do sth
fi
```

ðŸŒ°

```bash
# clean
while read LINE; do
    TTL=`redis-cli ttl "$LINE"`
    if [ $TTL -eq -1 ]; then
        redis-cli del $LINE > /dev/null  # ä¸è¾“å‡ºæ‰§è¡Œç»“æžœ
        echo "DEL $LINE"
    fi
done

# redis-cli keys "prefix:*" | ./clean
```

```
redis-cli keys "prefix:*" | while read LINE; do TTL=`redis-cli ttl "$LINE"`; if [ $TTL -eq -1 ]; then redis-cli del $LINE > /dev/null; echo "DEL $LINE"; fi; done;
```


`1460 days left`

